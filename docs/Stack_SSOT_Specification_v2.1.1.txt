# Stack ê¸°ìˆ /ê¸°ëŠ¥ ëª…ì„¸ì„œ v2.1.1
## (SSOT í™•ì •ìš© / Phase 1 ì •í•©ì„± íŒ¨ì¹˜ ë°˜ì˜íŒ)

---

# 0. í”„ë¡œì íŠ¸ ê°œìš”

## 0.1 ê¸°ë³¸ ì •ë³´
| í•­ëª© | ê°’ |
|------|-----|
| ì•± ì´ë¦„ | Stack |
| íŒ¨í‚¤ì§€ëª… | `com.stack.player` |
| í”Œë«í¼ | Android |
| minSdk | 26 |
| targetSdk | 35 |
| compileSdk | 35 |
| í•µì‹¬ ì² í•™ | Document-oriented Music Archiving (Notion í†¤ + íƒœê·¸ ê¸°ë°˜ ì •ë¦¬) |
| ì•„í‚¤í…ì²˜ | MVVM + Clean Architecture |
| ëª¨ë“ˆ êµ¬ì¡° | ë©€í‹°ëª¨ë“ˆ (:core, :data, :domain, :feature:*) |
| ë¹Œë“œ ì‹œìŠ¤í…œ | Gradle KTS + Version Catalog |
| JDK | 17 |
| ì§€ì› ì–¸ì–´ | í•œêµ­ì–´, English, æ—¥æœ¬èª |

## 0.2 SSOT ì›ì¹™ (ë¹Œë“œ ì•ˆì •ì„±)
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì€ **"í•œ ë²ˆ ê³ ì •"** í›„ PR ê²½ê³„ì—ì„œë§Œ ì—…ë°ì´íŠ¸
- ë„ì¤‘ ì—…ê·¸ë ˆì´ë“œ/ì‹¤í—˜ ë¸Œëœì¹˜ ë³‘í–‰ ê¸ˆì§€ (ì»´íŒŒì¼/ëŸ°íƒ€ì„ ë¶ˆì¼ì¹˜ ë°©ì§€)
- ëª¨ë“  ë²„ì „ì€ `libs.versions.toml`ì—ì„œ ë‹¨ì¼ ê´€ë¦¬

---

# 1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ë§¤íŠ¸ë¦­ìŠ¤ (í™•ì •)

## 1.1 Core Dependencies

```toml
[versions]
# Build Tools
agp = "8.7.3"
kotlin = "2.0.21"
ksp = "2.0.21-1.0.28"

# AndroidX Core
coreKtx = "1.15.0"
appcompat = "1.7.0"
activityCompose = "1.9.3"
lifecycleRuntimeKtx = "2.8.7"

# Compose
composeBom = "2024.12.01"

# Navigation
navigation = "2.8.5"

# DI
hilt = "2.56.2"
hiltNavigationCompose = "1.2.0"

# Database
room = "2.6.1"
datastore = "1.1.3"

# Media
media3 = "1.5.1"

# Image
coil = "3.0.4"

# Async
coroutines = "1.9.0"

# Testing
junit = "4.13.2"
junitVersion = "1.2.1"
espressoCore = "3.6.1"
```

## 1.2 í˜¸í™˜ì„± ê²€ì¦ ê²°ê³¼

| ì¡°í•© | ê²€ì¦ ìƒíƒœ |
|------|----------|
| Kotlin 2.0.21 + KSP 2.0.21-1.0.28 | âœ… í˜¸í™˜ |
| Kotlin 2.0.21 + Hilt 2.56.2 (KSP) | âœ… í˜¸í™˜ |
| Kotlin 2.0.21 + Room 2.6.1 (KSP) | âœ… í˜¸í™˜ |
| Compose BOM 2024.12.01 + Navigation 2.8.5 | âœ… í˜¸í™˜ |
| AGP 8.7.3 + targetSdk 35 | âœ… í˜¸í™˜ |
| Media3 1.5.1 + targetSdk 35 | âœ… í˜¸í™˜ |

---

# 2. ë©€í‹°ëª¨ë“ˆ êµ¬ì¡°

## 2.1 ëª¨ë“ˆ ì˜ì¡´ì„± ê·¸ë˜í”„

```
app
â”œâ”€â”€ :feature:gate
â”œâ”€â”€ :feature:library
â”œâ”€â”€ :feature:player
â”œâ”€â”€ :feature:search
â”œâ”€â”€ :feature:tags
â”œâ”€â”€ :feature:playlists
â”œâ”€â”€ :feature:settings
â”œâ”€â”€ :domain
â”œâ”€â”€ :data
â””â”€â”€ :core

:feature:* â†’ :domain, :core
:domain â†’ :core (ëª¨ë¸ë§Œ)
:data â†’ :domain, :core
:core â†’ (ì˜ì¡´ì„± ì—†ìŒ)
```

## 2.2 ê° ëª¨ë“ˆ ì±…ì„

| ëª¨ë“ˆ | ì±…ì„ | ì£¼ìš” ë‚´ìš© |
|------|------|---------|
| `:app` | ì•± ì§„ì…ì , DI ì¡°ë¦½ | Application, MainActivity, NavHost |
| `:core` | ê³µí†µ ìœ í‹¸ë¦¬í‹° | Result, Dispatchers, Logger, CrashCapture, Theme, **BaseViewModel, UiState, CoreModule(DI)** |
| `:data` | ë°ì´í„° ë ˆì´ì–´ | Room, DataStore, Repository êµ¬í˜„, Scanner |
| `:domain` | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ | UseCase, Repository ì¸í„°í˜ì´ìŠ¤, Domain ëª¨ë¸ |
| `:feature:*` | UI ë ˆì´ì–´ | Screen, ViewModel, Components |

## 2.3 ìƒì„¸ íŒŒì¼ íŠ¸ë¦¬

```
stack/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ build.gradle.kts
â”‚   â””â”€â”€ src/main/
â”‚       â”œâ”€â”€ AndroidManifest.xml
â”‚       â””â”€â”€ kotlin/com/stack/
â”‚           â”œâ”€â”€ StackApplication.kt
â”‚           â”œâ”€â”€ MainActivity.kt
â”‚           â”œâ”€â”€ navigation/
â”‚           â”‚   â”œâ”€â”€ StackNavHost.kt
â”‚           â”‚   â””â”€â”€ NavRoutes.kt
â”‚           â””â”€â”€ di/
â”‚               â””â”€â”€ AppModule.kt
â”‚
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ build.gradle.kts
â”‚   â””â”€â”€ src/main/kotlin/com/stack/core/
â”‚       â”œâ”€â”€ base/
â”‚       â”‚   â”œâ”€â”€ BaseViewModel.kt
â”‚       â”‚   â””â”€â”€ UiState.kt
â”‚       â”œâ”€â”€ di/
â”‚       â”‚   â””â”€â”€ CoreModule.kt
â”‚       â”œâ”€â”€ util/
â”‚       â”‚   â”œâ”€â”€ CoroutineDispatchers.kt
â”‚       â”‚   â”œâ”€â”€ Result.kt
â”‚       â”‚   â”œâ”€â”€ DateTimeUtil.kt
â”‚       â”‚   â””â”€â”€ StringUtil.kt
â”‚       â”œâ”€â”€ logging/
â”‚       â”‚   â””â”€â”€ Logger.kt
â”‚       â”œâ”€â”€ crash/
â”‚       â”‚   â””â”€â”€ CrashCapture.kt
â”‚       â””â”€â”€ ui/
â”‚           â””â”€â”€ theme/
â”‚               â”œâ”€â”€ Theme.kt
â”‚               â”œâ”€â”€ Color.kt
â”‚               â”œâ”€â”€ Typography.kt
â”‚               â”œâ”€â”€ Spacing.kt
â”‚               â””â”€â”€ Shape.kt
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ build.gradle.kts
â”‚   â””â”€â”€ src/main/kotlin/com/stack/data/
â”‚       â”œâ”€â”€ local/
â”‚       â”‚   â”œâ”€â”€ db/
â”‚       â”‚   â”‚   â”œâ”€â”€ StackDatabase.kt
â”‚       â”‚   â”‚   â”œâ”€â”€ entity/
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ TrackEntity.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ TagEntity.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ TrackTagCrossRef.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ PlaylistEntity.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ PlaylistTrackCrossRef.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ LyricsEntity.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ LyricsFtsEntity.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ PlayHistoryEntity.kt
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ SourceFolderEntity.kt
â”‚       â”‚   â”‚   â”œâ”€â”€ dao/
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ TrackDao.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ TrackFtsDao.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ TagDao.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ PlaylistDao.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ LyricsDao.kt
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ PlayHistoryDao.kt
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ SourceFolderDao.kt
â”‚       â”‚   â”‚   â””â”€â”€ converter/
â”‚       â”‚   â”‚       â””â”€â”€ Converters.kt
â”‚       â”‚   â””â”€â”€ prefs/
â”‚       â”‚       â”œâ”€â”€ PreferencesDataStore.kt
â”‚       â”‚       â””â”€â”€ PreferencesKeys.kt
â”‚       â”œâ”€â”€ repository/
â”‚       â”‚   â”œâ”€â”€ TrackRepositoryImpl.kt
â”‚       â”‚   â”œâ”€â”€ TagRepositoryImpl.kt
â”‚       â”‚   â”œâ”€â”€ PlaylistRepositoryImpl.kt
â”‚       â”‚   â”œâ”€â”€ SourceFolderRepositoryImpl.kt
â”‚       â”‚   â”œâ”€â”€ PlayHistoryRepositoryImpl.kt
â”‚       â”‚   â”œâ”€â”€ LyricsRepositoryImpl.kt
â”‚       â”‚   â””â”€â”€ SettingsRepositoryImpl.kt
â”‚       â”œâ”€â”€ mapper/
â”‚       â”‚   â”œâ”€â”€ TrackMapper.kt
â”‚       â”‚   â”œâ”€â”€ TagMapper.kt
â”‚       â”‚   â””â”€â”€ PlaylistMapper.kt
â”‚       â”œâ”€â”€ scanner/
â”‚       â”‚   â”œâ”€â”€ MediaStoreScanner.kt
â”‚       â”‚   â”œâ”€â”€ ScanManager.kt
â”‚       â”‚   â”œâ”€â”€ ContentObserverManager.kt
â”‚       â”‚   â””â”€â”€ ScanState.kt
â”‚       â””â”€â”€ di/
â”‚           â”œâ”€â”€ DatabaseModule.kt
â”‚           â”œâ”€â”€ RepositoryModule.kt
â”‚           â””â”€â”€ ScannerModule.kt
â”‚
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ build.gradle.kts
â”‚   â””â”€â”€ src/main/kotlin/com/stack/domain/
â”‚       â”œâ”€â”€ model/
â”‚       â”‚   â”œâ”€â”€ Track.kt
â”‚       â”‚   â”œâ”€â”€ Tag.kt
â”‚       â”‚   â”œâ”€â”€ Playlist.kt
â”‚       â”‚   â”œâ”€â”€ Lyrics.kt
â”‚       â”‚   â”œâ”€â”€ SourceFolder.kt
â”‚       â”‚   â”œâ”€â”€ PlayHistory.kt
â”‚       â”‚   â”œâ”€â”€ PlaybackState.kt
â”‚       â”‚   â”œâ”€â”€ QueueState.kt
â”‚       â”‚   â””â”€â”€ GateState.kt
â”‚       â”œâ”€â”€ repository/
â”‚       â”‚   â”œâ”€â”€ TrackRepository.kt
â”‚       â”‚   â”œâ”€â”€ TagRepository.kt
â”‚       â”‚   â”œâ”€â”€ PlaylistRepository.kt
â”‚       â”‚   â”œâ”€â”€ SourceFolderRepository.kt
â”‚       â”‚   â”œâ”€â”€ PlayHistoryRepository.kt
â”‚       â”‚   â”œâ”€â”€ LyricsRepository.kt
â”‚       â”‚   â””â”€â”€ SettingsRepository.kt
â”‚       â””â”€â”€ usecase/
â”‚           â”œâ”€â”€ track/
â”‚           â”‚   â”œâ”€â”€ GetTracksUseCase.kt
â”‚           â”‚   â”œâ”€â”€ SearchTracksUseCase.kt
â”‚           â”‚   â””â”€â”€ DeleteTrackUseCase.kt
â”‚           â”œâ”€â”€ tag/
â”‚           â”‚   â”œâ”€â”€ GetTagsUseCase.kt
â”‚           â”‚   â”œâ”€â”€ ApplyTagsUseCase.kt
â”‚           â”‚   â””â”€â”€ GetRelatedTagsUseCase.kt
â”‚           â”œâ”€â”€ playlist/
â”‚           â”‚   â”œâ”€â”€ GetPlaylistsUseCase.kt
â”‚           â”‚   â”œâ”€â”€ CreatePlaylistUseCase.kt
â”‚           â”‚   â””â”€â”€ AddToPlaylistUseCase.kt
â”‚           â”œâ”€â”€ scan/
â”‚           â”‚   â””â”€â”€ ScanLibraryUseCase.kt
â”‚           â””â”€â”€ history/
â”‚               â”œâ”€â”€ RecordPlayUseCase.kt
â”‚               â””â”€â”€ GetPlayStatsUseCase.kt
â”‚
â”œâ”€â”€ feature/
â”‚   â”œâ”€â”€ gate/
â”‚   â”‚   â””â”€â”€ src/main/kotlin/com/stack/feature/gate/
â”‚   â”‚       â”œâ”€â”€ GateScreen.kt
â”‚   â”‚       â”œâ”€â”€ GateViewModel.kt
â”‚   â”‚       â”œâ”€â”€ PermissionDeck.kt
â”‚   â”‚       â””â”€â”€ components/
â”‚   â”‚           â”œâ”€â”€ PermissionCard.kt
â”‚   â”‚           â”œâ”€â”€ FolderSelectCard.kt
â”‚   â”‚           â””â”€â”€ ScanProgressCard.kt
â”‚   â”‚
â”‚   â”œâ”€â”€ library/
â”‚   â”‚   â””â”€â”€ src/main/kotlin/com/stack/feature/library/
â”‚   â”‚       â”œâ”€â”€ LibraryScreen.kt
â”‚   â”‚       â”œâ”€â”€ LibraryViewModel.kt
â”‚   â”‚       â”œâ”€â”€ TracksTab.kt
â”‚   â”‚       â”œâ”€â”€ AlbumsTab.kt
â”‚   â”‚       â”œâ”€â”€ ArtistsTab.kt
â”‚   â”‚       â”œâ”€â”€ FoldersTab.kt
â”‚   â”‚       â””â”€â”€ components/
â”‚   â”‚           â”œâ”€â”€ TrackRow.kt
â”‚   â”‚           â”œâ”€â”€ AlbumCard.kt
â”‚   â”‚           â”œâ”€â”€ ArtistRow.kt
â”‚   â”‚           â””â”€â”€ FolderBreadcrumb.kt
â”‚   â”‚
â”‚   â”œâ”€â”€ player/
â”‚   â”‚   â””â”€â”€ src/main/kotlin/com/stack/feature/player/
â”‚   â”‚       â”œâ”€â”€ PlayerScreen.kt
â”‚   â”‚       â”œâ”€â”€ PlayerViewModel.kt
â”‚   â”‚       â”œâ”€â”€ MiniPlayer.kt
â”‚   â”‚       â”œâ”€â”€ playback/
â”‚   â”‚       â”‚   â”œâ”€â”€ StackPlayer.kt
â”‚   â”‚       â”‚   â”œâ”€â”€ StackPlayerImpl.kt
â”‚   â”‚       â”‚   â”œâ”€â”€ DualPlayerManager.kt
â”‚   â”‚       â”‚   â””â”€â”€ PlayerCallback.kt
â”‚   â”‚       â”œâ”€â”€ queue/
â”‚   â”‚       â”‚   â”œâ”€â”€ PlaybackQueueManager.kt
â”‚   â”‚       â”‚   â””â”€â”€ ShuffleManager.kt
â”‚   â”‚       â”œâ”€â”€ session/
â”‚   â”‚       â”‚   â”œâ”€â”€ PlaybackSessionManager.kt
â”‚   â”‚       â”‚   â””â”€â”€ SessionSerializer.kt
â”‚   â”‚       â”œâ”€â”€ audio/
â”‚   â”‚       â”‚   â”œâ”€â”€ AudioFocusManager.kt
â”‚   â”‚       â”‚   â””â”€â”€ NoisyReceiver.kt
â”‚   â”‚       â”œâ”€â”€ service/
â”‚   â”‚       â”‚   â”œâ”€â”€ PlaybackService.kt
â”‚   â”‚       â”‚   â””â”€â”€ NotificationProvider.kt
â”‚   â”‚       â””â”€â”€ components/
â”‚   â”‚           â”œâ”€â”€ PlayerControls.kt
â”‚   â”‚           â”œâ”€â”€ ProgressBar.kt
â”‚   â”‚           â”œâ”€â”€ AmbientBackground.kt
â”‚   â”‚           â””â”€â”€ QueueList.kt
â”‚   â”‚
â”‚   â”œâ”€â”€ search/
â”‚   â”‚   â””â”€â”€ src/main/kotlin/com/stack/feature/search/
â”‚   â”‚       â”œâ”€â”€ SearchScreen.kt
â”‚   â”‚       â”œâ”€â”€ SearchViewModel.kt
â”‚   â”‚       â””â”€â”€ components/
â”‚   â”‚           â”œâ”€â”€ SearchBar.kt
â”‚   â”‚           â”œâ”€â”€ FilterChips.kt
â”‚   â”‚           â””â”€â”€ SearchResults.kt
â”‚   â”‚
â”‚   â”œâ”€â”€ tags/
â”‚   â”‚   â””â”€â”€ src/main/kotlin/com/stack/feature/tags/
â”‚   â”‚       â”œâ”€â”€ TagsScreen.kt
â”‚   â”‚       â”œâ”€â”€ TagsViewModel.kt
â”‚   â”‚       â”œâ”€â”€ TagDetailScreen.kt
â”‚   â”‚       â””â”€â”€ components/
â”‚   â”‚           â”œâ”€â”€ TagChip.kt
â”‚   â”‚           â”œâ”€â”€ TagEditor.kt
â”‚   â”‚           â””â”€â”€ TagSelector.kt
â”‚   â”‚
â”‚   â”œâ”€â”€ playlists/
â”‚   â”‚   â””â”€â”€ src/main/kotlin/com/stack/feature/playlists/
â”‚   â”‚       â”œâ”€â”€ PlaylistsScreen.kt
â”‚   â”‚       â”œâ”€â”€ PlaylistDetailScreen.kt
â”‚   â”‚       â”œâ”€â”€ PlaylistsViewModel.kt
â”‚   â”‚       â””â”€â”€ components/
â”‚   â”‚           â”œâ”€â”€ PlaylistCard.kt
â”‚   â”‚           â””â”€â”€ DraggableTrackList.kt
â”‚   â”‚
â”‚   â””â”€â”€ settings/
â”‚       â””â”€â”€ src/main/kotlin/com/stack/feature/settings/
â”‚           â”œâ”€â”€ SettingsScreen.kt
â”‚           â”œâ”€â”€ SettingsViewModel.kt
â”‚           â”œâ”€â”€ StatsScreen.kt
â”‚           â”œâ”€â”€ CrashReportScreen.kt
â”‚           â””â”€â”€ components/
â”‚               â”œâ”€â”€ SettingsRow.kt
â”‚               â””â”€â”€ ThemePicker.kt
â”‚
â”œâ”€â”€ gradle/
â”‚   â””â”€â”€ libs.versions.toml
â”œâ”€â”€ build.gradle.kts
â”œâ”€â”€ settings.gradle.kts
â””â”€â”€ docs/
    â”œâ”€â”€ SSOT_MASTER.md
    â”œâ”€â”€ SSOT_ARCHITECTURE.md
    â”œâ”€â”€ SSOT_PLAYBACK.md
    â”œâ”€â”€ SSOT_GATE.md
    â””â”€â”€ CODING_CONVENTIONS.md
```

---

# 3. Gate(ì˜¨ë³´ë”©) â€” "ê¶Œí•œ + SAF ì†ŒìŠ¤í´ë”(í•„ìˆ˜) + ìŠ¤ìº”"

## 3.1 Permission Deck (ì¹´ë“œ ìŠ¤ì™€ì´í”„)

| Step | ë‚´ìš© | í•„ìˆ˜ ì—¬ë¶€ |
|------|------|----------|
| 1 | í™˜ì˜ ("ë‹¹ì‹ ì˜ ìŒì•…ì„ ê¸°ë¡í•˜ì„¸ìš”") | - |
| 2 | ë¯¸ë””ì–´ ì ‘ê·¼ ê¶Œí•œ | í•„ìˆ˜ |
| 3 | ì•Œë¦¼ ê¶Œí•œ (Android 13+) | ê¶Œì¥ |
| 4 | ì†ŒìŠ¤ í´ë” ì„ íƒ (SAF) | í•„ìˆ˜ |
| 5 | ìŠ¤ìº” ì§„í–‰ | ìë™ |

### ê¶Œí•œ ìƒì„¸

| API Level | ë¯¸ë””ì–´ ê¶Œí•œ |
|-----------|-----------|
| Android 13+ (API 33+) | `READ_MEDIA_AUDIO` |
| Android 12 ì´í•˜ | `READ_EXTERNAL_STORAGE` |

### SAF ì†ŒìŠ¤í´ë”

- ì‚¬ìš©ìëŠ” **1ê°œ ì´ìƒ**ì˜ í´ë”(Tree URI)ë¥¼ ì„ íƒí•´ì•¼ í•¨
- ì„ íƒëœ í´ë”ëŠ” **Persisted URI Permission**ìœ¼ë¡œ ì €ì¥ (ì¬ë¶€íŒ…/ì¬ì‹¤í–‰ ìœ ì§€)
- `ContentResolver.takePersistableUriPermission()` ì‚¬ìš©

## 3.2 GateReady ì •ì˜ (ì—„ê²©)

```kotlin
data class GateState(
    val hasMediaPermission: Boolean,
    val hasNotificationPermission: Boolean, // ì„ íƒì 
    val sourceFolderCount: Int,
    val scanState: ScanState
) {
    val isGateReady: Boolean
        get() = hasMediaPermission && sourceFolderCount >= 1
}
```

### GateReady ì´ì „ ì œí•œ

- ë¼ì´ë¸ŒëŸ¬ë¦¬/ê²€ìƒ‰/í”Œë ˆì´ì–´/ë¯¸ë‹ˆí”Œë ˆì´ì–´/ì„¸ì…˜ ë³µì› UI **ë…¸ì¶œ ê¸ˆì§€**
- ëª¨ë“  NavRouteëŠ” `GateReady` ì²´í¬ í›„ ì§„ì…

### GateReady ìˆœê°„ ì •ì±…

1. ì„¸ì…˜ ë³µì›ì€ **"í•­ìƒ Pause ìƒíƒœ"**
2. ì´ˆê¸° í’€ìŠ¤ìº” **1íšŒ** íŠ¸ë¦¬ê±°
3. "ì„¸ì…˜ì´ ì¼ì‹œì •ì§€ ìƒíƒœë¡œ ë³µì›ë¨" **1íšŒ ì•ˆë‚´** (ìŠ¤ë‚µë°”, ê³¼ì¥ ê¸ˆì§€)

## 3.3 ì‹¤íŒ¨/ê±°ë¶€ UX

| ìƒí™© | UX |
|------|-----|
| ê¶Œí•œ ê±°ë¶€ | "ìŒì•… ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤" + [ì„¤ì •ìœ¼ë¡œ ì´ë™] ë²„íŠ¼ 1ê°œ |
| í´ë” ë¯¸ì„ íƒ | "ìŒì•…ì´ ìˆëŠ” í´ë”ë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤" + [í´ë” ì„ íƒ] ë²„íŠ¼ 1ê°œ |
| ìŠ¤ìº” ì‹¤íŒ¨ | ì˜¤ë¥˜ ì›ì¸ë³„ + [ì¬ì‹œë„] ë²„íŠ¼ 1ê°œ |
| ê¶Œí•œ ì˜êµ¬ ê±°ë¶€ | ì„¤ì • ì•±ìœ¼ë¡œ ì•ˆë‚´ (Intent) |

---

# 4. ì €ì¥ì†Œ ì ‘ê·¼/í´ë” íƒ­

## 4.1 ì›ì¹™

- ë‚´ë¶€ ë¡œì§ì˜ ì •ë³¸ URI: **SAF Tree URI + MediaStore contentUri**
- UI í‘œì‹œ ê²½ë¡œ: **ì‚¬ìš©ìê°€ ì„ íƒí•œ í´ë” íŠ¸ë¦¬ ê¸°ì¤€**ìœ¼ë¡œ ì‹¤ê²½ë¡œì²˜ëŸ¼ êµ¬ì„±

## 4.2 ê²½ë¡œ í‘œì‹œ ì •ì±… (ìš°ì„ ìˆœìœ„)

| ìš°ì„ ìˆœìœ„ | ë°©ì‹ | ì˜ˆì‹œ |
|---------|------|------|
| 1 | SAF íŠ¸ë¦¬ì—ì„œì˜ ìƒëŒ€ ê²½ë¡œ Breadcrumb | `Storage / Music / Pop / 1990s` |
| 2 | MediaStore RELATIVE_PATH ì¡°í•© | `Internal Storage / Music / Pop` |
| 3 | ê²½ë¡œ ê³„ì‚° ë¶ˆê°€ ì‹œ ì¶•ì•½ | `Storage / ... / <FolderName>` |

### ì ˆëŒ€ ê¸ˆì§€

- ì‹¤ì œ ì ˆëŒ€ê²½ë¡œ íšë“ì„ ìœ„í•œ ë¹„í‘œì¤€/ë¶ˆì•ˆì • í•´í‚¹

---

# 5. ìŠ¤ìº”Â·ë™ê¸°í™” ì •ì±…

## 5.1 ìŠ¤ìº” íŠ¸ë¦¬ê±°

| íŠ¸ë¦¬ê±° | ë™ì‘ |
|--------|------|
| ì•± ì‹œì‘ | ì¦ë¶„ ìŠ¤ìº” (ìë™) |
| MediaStore ë³€ê²½ ê°ì§€ | ë””ë°”ìš´ìŠ¤ í›„ ì¦ë¶„ ìŠ¤ìº” í ì ì¬ |
| ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨ | ì¦‰ì‹œ ì¦ë¶„ ìŠ¤ìº” |
| ì†ŒìŠ¤í´ë” ì¶”ê°€ | í•´ë‹¹ í´ë” í’€ìŠ¤ìº” |

## 5.2 ì‹ë³„/ì¤‘ë³µ íŒì •

```kotlin
// íŠ¸ë™ ì‹ë³„ ê¸°ì¤€
data class TrackIdentifier(
    val contentUri: Uri,      // ì£¼í‚¤
    val size: Long,           // ë³´ì¡°í‚¤
    val dateModified: Long    // ë³´ì¡°í‚¤
)
```

| ì¡°ê±´ | íŒì • |
|------|------|
| ë™ì¼ contentUri | ë™ì¼ íŠ¸ë™ |
| contentUri ë‹¤ë¦„ + (size, dateModified ë™ì¼) | "ì˜ì‹¬ ì¤‘ë³µ" ë§ˆí‚¹, ë³„ê°œ íŠ¸ë™ ì·¨ê¸‰ |

> ì¤‘ë³µ ë³‘í•© ê¸°ëŠ¥ì€ **MVP ì´í›„** (Phase 2+)

## 5.3 ì‚­ì œ/ì´ë™ ê°ì§€ (Ghost ì •ì±…)

```kotlin
enum class TrackStatus {
    ACTIVE,    // ì •ìƒ
    GHOST,     // ì ‘ê·¼ ë¶ˆê°€ (ì‚­ì œ/ì´ë™ ì¶”ì •)
    DELETED    // ì‚¬ìš©ìê°€ ì‚­ì œ í™•ì •
}
```

| ìƒí™© | ë™ì‘ |
|------|------|
| contentUri ì ‘ê·¼ ë¶ˆê°€ | `GHOST` ìƒíƒœë¡œ ë§ˆí‚¹ |
| Ghost íŠ¸ë™ ì¡´ì¬ | ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒë‹¨ "ì •ë¦¬ í•„ìš”" ë°°ë„ˆ |
| ë°°ë„ˆ ì•¡ì…˜ | [ì¼ê´„ ì œê±°] / [ì¬ìŠ¤ìº”] |
| Ghost íŠ¸ë™ ê¸°ë³¸ ë™ì‘ | ê²€ìƒ‰/ìë™ì¬ìƒ/í êµ¬ì„±ì—ì„œ **ì œì™¸** |

## 5.4 ì„±ëŠ¥/ì•ˆì •ì„± ê·œì¹™

| ê·œì¹™ | êµ¬í˜„ |
|------|------|
| ìŠ¤ìº” ìŠ¤ë ˆë“œ | `Dispatchers.IO` + ì·¨ì†Œ ê°€ëŠ¥ |
| ì¤‘ë³µ ìš”ì²­ ë°©ì§€ | `MutexGuard` ë‹¨ì¼ ìŠ¤ìº” íŒŒì´í”„ë¼ì¸ |
| UI ì—…ë°ì´íŠ¸ | Flow + `sample(100ms)` / `throttleLatest` |
| ìŠ¤ìº” ë””ë°”ìš´ìŠ¤ | **3ì´ˆ** (SSOT í™•ì •) |

---

# 6. ë°ì´í„° ëª¨ë¸/DB

## 6.1 DB ê¸°ë³¸ ì„¤ì •

| í•­ëª© | ê°’ |
|------|-----|
| DB íŒŒì¼ ì´ë¦„ | `stack_database` |
| schemaVersion | 1 (ì´ˆê¸°) |
| FTS í† í°í™” | `unicode61` |
| ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ | Room AutoMigration í™œìš© |

## 6.2 Entity ìƒì„¸

### TrackEntity

```kotlin
@Entity(
    tableName = "tracks",
    indices = [
        Index("content_uri", unique = true),
        Index("album_id"),
        Index("artist_id"),
        Index("folder_path"),
        Index("status")
    ]
)
data class TrackEntity(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    
    // ì‹ë³„ì
    @ColumnInfo(name = "content_uri")
    val contentUri: String,
    
    // ë©”íƒ€ë°ì´í„°
    val title: String,
    val artist: String?,
    @ColumnInfo(name = "album_artist")
    val albumArtist: String?,
    val album: String?,
    @ColumnInfo(name = "album_id")
    val albumId: Long?,
    @ColumnInfo(name = "artist_id") 
    val artistId: Long?,
    val genre: String?,
    val year: Int?,
    @ColumnInfo(name = "track_number")
    val trackNumber: Int?,
    @ColumnInfo(name = "disc_number")
    val discNumber: Int?,
    
    // íŒŒì¼ ì •ë³´
    val duration: Long,           // ms
    val size: Long,               // bytes
    @ColumnInfo(name = "bit_rate")
    val bitRate: Int?,            // kbps
    @ColumnInfo(name = "sample_rate")
    val sampleRate: Int?,         // Hz
    @ColumnInfo(name = "mime_type")
    val mimeType: String,
    
    // ê²½ë¡œ ì •ë³´
    @ColumnInfo(name = "folder_path")
    val folderPath: String,
    @ColumnInfo(name = "file_name")
    val fileName: String,
    @ColumnInfo(name = "display_path")
    val displayPath: String,      // UI í‘œì‹œìš©
    
    // ì•¨ë²”ì•„íŠ¸
    @ColumnInfo(name = "album_art_uri")
    val albumArtUri: String?,
    
    // ìƒíƒœ
    val status: TrackStatus = TrackStatus.ACTIVE,
    
    // íƒ€ì„ìŠ¤íƒ¬í”„
    @ColumnInfo(name = "date_added")
    val dateAdded: Long,          // ì•±ì— ì¶”ê°€ëœ ì‹œê°„
    @ColumnInfo(name = "date_modified")
    val dateModified: Long,       // íŒŒì¼ ìˆ˜ì • ì‹œê°„
    @ColumnInfo(name = "last_scanned")
    val lastScanned: Long         // ë§ˆì§€ë§‰ ìŠ¤ìº” ì‹œê°„
)
```

### TrackFtsEntity (FTS5 ê²€ìƒ‰ìš©)

```kotlin
@Entity(tableName = "tracks_fts")
@Fts4(contentEntity = TrackEntity::class)
data class TrackFtsEntity(
    val title: String,
    val artist: String?,
    val album: String?,
    @ColumnInfo(name = "album_artist")
    val albumArtist: String?
)
```

### TagEntity

```kotlin
@Entity(
    tableName = "tags",
    indices = [Index("name", unique = true)]
)
data class TagEntity(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    val name: String,
    val color: Int,               // ARGB
    @ColumnInfo(name = "is_system")
    val isSystem: Boolean = false,
    @ColumnInfo(name = "system_type")
    val systemType: SystemTagType? = null,
    @ColumnInfo(name = "created_at")
    val createdAt: Long,
    @ColumnInfo(name = "updated_at")
    val updatedAt: Long
)

enum class SystemTagType {
    FAVORITE,       // â¤ï¸ ì¢‹ì•„ìš”
    RECENT_PLAY,    // ğŸ• ìµœê·¼ ì¬ìƒ
    RECENT_ADD,     // ğŸ†• ìµœê·¼ ì¶”ê°€
    MOST_PLAYED     // ğŸ”¥ ë§ì´ ì¬ìƒ
}
```

### TrackTagCrossRef (Track-Tag M:N ê´€ê³„)

```kotlin
@Entity(
    tableName = "track_tag_cross_ref",
    primaryKeys = ["track_id", "tag_id"],
    foreignKeys = [
        ForeignKey(
            entity = TrackEntity::class,
            parentColumns = ["id"],
            childColumns = ["track_id"],
            onDelete = ForeignKey.CASCADE
        ),
        ForeignKey(
            entity = TagEntity::class,
            parentColumns = ["id"],
            childColumns = ["tag_id"],
            onDelete = ForeignKey.CASCADE
        )
    ],
    indices = [
        Index("track_id"),
        Index("tag_id")
    ]
)
data class TrackTagCrossRef(
    @ColumnInfo(name = "track_id")
    val trackId: Long,
    @ColumnInfo(name = "tag_id")
    val tagId: Long,
    @ColumnInfo(name = "tagged_at")
    val taggedAt: Long = System.currentTimeMillis()
)
```

### PlaylistEntity

```kotlin
@Entity(
    tableName = "playlists",
    indices = [Index("name")]
)
data class PlaylistEntity(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    val name: String,
    val description: String?,
    @ColumnInfo(name = "cover_art_uri")
    val coverArtUri: String?,
    @ColumnInfo(name = "is_smart_playlist")
    val isSmartPlaylist: Boolean = false,
    @ColumnInfo(name = "smart_criteria")
    val smartCriteria: String? = null,  // JSON for smart playlist rules
    @ColumnInfo(name = "created_at")
    val createdAt: Long,
    @ColumnInfo(name = "updated_at")
    val updatedAt: Long
)
```

### PlaylistTrackCrossRef (Playlist-Track M:N ê´€ê³„)

```kotlin
@Entity(
    tableName = "playlist_track_cross_ref",
    primaryKeys = ["playlist_id", "track_id"],
    foreignKeys = [
        ForeignKey(
            entity = PlaylistEntity::class,
            parentColumns = ["id"],
            childColumns = ["playlist_id"],
            onDelete = ForeignKey.CASCADE
        ),
        ForeignKey(
            entity = TrackEntity::class,
            parentColumns = ["id"],
            childColumns = ["track_id"],
            onDelete = ForeignKey.CASCADE
        )
    ],
    indices = [
        Index("playlist_id"),
        Index("track_id"),
        Index("position")
    ]
)
data class PlaylistTrackCrossRef(
    @ColumnInfo(name = "playlist_id")
    val playlistId: Long,
    @ColumnInfo(name = "track_id")
    val trackId: Long,
    val position: Int,
    @ColumnInfo(name = "added_at")
    val addedAt: Long = System.currentTimeMillis()
)
```

### SourceFolderEntity

```kotlin
@Entity(
    tableName = "source_folders",
    indices = [Index("tree_uri", unique = true)]
)
data class SourceFolderEntity(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    @ColumnInfo(name = "tree_uri")
    val treeUri: String,
    @ColumnInfo(name = "display_name")
    val displayName: String,
    @ColumnInfo(name = "display_path")
    val displayPath: String,
    @ColumnInfo(name = "track_count")
    val trackCount: Int = 0,
    @ColumnInfo(name = "last_scanned")
    val lastScanned: Long? = null,
    @ColumnInfo(name = "added_at")
    val addedAt: Long,
    @ColumnInfo(name = "is_active")
    val isActive: Boolean = true
)
```

### PlayHistoryEntity

```kotlin
@Entity(
    tableName = "play_history",
    foreignKeys = [
        ForeignKey(
            entity = TrackEntity::class,
            parentColumns = ["id"],
            childColumns = ["track_id"],
            onDelete = ForeignKey.CASCADE
        )
    ],
    indices = [
        Index("track_id"),
        Index("played_at"),
        Index("week_key")
    ]
)
data class PlayHistoryEntity(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    @ColumnInfo(name = "track_id")
    val trackId: Long,
    @ColumnInfo(name = "played_at")
    val playedAt: Long,           // ì¬ìƒ ì‹œì‘ ì‹œê°„
    @ColumnInfo(name = "played_duration")
    val playedDuration: Long,     // ì‹¤ì œ ì¬ìƒ ì‹œê°„ (ms)
    @ColumnInfo(name = "completed")
    val completed: Boolean,       // ëê¹Œì§€ ì¬ìƒ ì—¬ë¶€
    @ColumnInfo(name = "week_key")
    val weekKey: String           // "2025-W01" í˜•ì‹ (ì£¼ê°„ ì§‘ê³„ìš©)
)
```

### LyricsEntity & LyricsFtsEntity

```kotlin
@Entity(
    tableName = "lyrics",
    foreignKeys = [
        ForeignKey(
            entity = TrackEntity::class,
            parentColumns = ["id"],
            childColumns = ["track_id"],
            onDelete = ForeignKey.CASCADE
        )
    ],
    indices = [Index("track_id", unique = true)]
)
data class LyricsEntity(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    @ColumnInfo(name = "track_id")
    val trackId: Long,
    val content: String,          // ê°€ì‚¬ ì›ë¬¸
    @ColumnInfo(name = "is_synced")
    val isSynced: Boolean,        // LRC ì‹œê°„ ë™ê¸°í™” ì—¬ë¶€
    @ColumnInfo(name = "lrc_data")
    val lrcData: String?,         // LRC íŒŒì‹± ë°ì´í„° (JSON)
    val source: LyricsSource,
    @ColumnInfo(name = "updated_at")
    val updatedAt: Long
)

enum class LyricsSource {
    EMBEDDED,      // íŒŒì¼ ë‚´ì¥
    SIDECAR_LRC,   // .lrc íŒŒì¼
    USER_INPUT,    // ì‚¬ìš©ì ì…ë ¥
    IMPORTED       // ì™¸ë¶€ ê°€ì ¸ì˜¤ê¸°
}

// ê°€ì‚¬ ê²€ìƒ‰ìš© ë³„ë„ FTS í…Œì´ë¸”
@Entity(tableName = "lyrics_fts")
@Fts4(contentEntity = LyricsEntity::class)
data class LyricsFtsEntity(
    val content: String
)
```

## 6.3 ì‹œìŠ¤í…œ íƒœê·¸ (í™•ì •)

| íƒœê·¸ | íƒ€ì… | ì¡°ê±´ | ì•„ì´ì½˜ |
|------|------|------|-------|
| ì¢‹ì•„ìš” | `FAVORITE` | ì‚¬ìš©ì ìˆ˜ë™ | â¤ï¸ |
| ìµœê·¼ ì¬ìƒ | `RECENT_PLAY` | ìµœê·¼ **30ì¼** ë‚´ ì¬ìƒ | ğŸ• |
| ìµœê·¼ ì¶”ê°€ | `RECENT_ADD` | ìµœê·¼ **30ì¼** ë‚´ ì¶”ê°€ | ğŸ†• |
| ë§ì´ ì¬ìƒ | `MOST_PLAYED` | ì¬ìƒ íšŸìˆ˜ ìƒìœ„, ìµœëŒ€ **100ê³¡** | ğŸ”¥ |

### ì‹œìŠ¤í…œ íƒœê·¸ ë³´í˜¸ ì •ì±…

- `isSystem = true`ì¸ íƒœê·¸ëŠ” **ì‚­ì œ ë¶ˆê°€**
- ì´ë¦„ ë³€ê²½/ë³‘í•© **ê¸°ë³¸ ê¸ˆì§€** (Phase 2ì—ì„œ "í‘œì‹œ ì´ë¦„ë§Œ ë³€ê²½" ê²€í† )

## 6.4 ì¬ìƒê¸°ë¡ ì •ì±… (í™•ì •)

| í•­ëª© | ê°’ |
|------|-----|
| ê¸°ë³¸ ë³´ê´€ ê¸°ê°„ | **365ì¼** |
| ìƒì„¸ ê¸°ë¡ ê¸°ê°„ | ìµœê·¼ **30ì¼** (ì¼ ë‹¨ìœ„) |
| ì§‘ê³„ ê¸°ë¡ | 30ì¼ ì´ìƒì€ **ì£¼ ë‹¨ìœ„** ì§‘ê³„ |
| ì •ë¦¬ ì£¼ê¸° | ì•± ì‹œì‘ ì‹œ / 1ì¼ 1íšŒ |

```kotlin
// ì¬ìƒê¸°ë¡ ì¡°íšŒ ì˜ˆì‹œ
interface PlayHistoryRepository {
    // ìµœê·¼ 30ì¼: ì¼ë³„ ìƒì„¸
    fun getDetailedHistory(days: Int = 30): Flow<List<PlayHistory>>
    
    // 30ì¼ ì´ìƒ: ì£¼ê°„ ì§‘ê³„
    fun getWeeklyStats(startDate: LocalDate, endDate: LocalDate): Flow<List<WeeklyStat>>
}
```

## 6.5 ê²€ìƒ‰ ì¸ë±ìŠ¤ (í™•ì •)

| ëŒ€ìƒ | FTS ì ìš© | í…Œì´ë¸” |
|------|---------|--------|
| ì œëª©/ì•„í‹°ìŠ¤íŠ¸/ì•¨ë²” | âœ… | `tracks_fts` |
| íƒœê·¸ ì´ë¦„ | âŒ (LIKE ê²€ìƒ‰) | `tags` |
| ê°€ì‚¬ | âœ… (ë³„ë„) | `lyrics_fts` |

### ê°€ì‚¬ ì¸ë±ì‹± (í™•ì •)

- ê¸°ë³¸ê°’: **ON**
- ë³„ë„ í…Œì´ë¸”ë¡œ ë¶„ë¦¬ (ë©”ì¸ ê²€ìƒ‰ ì˜í–¥ ì°¨ë‹¨)
- ì´ˆê¸° ìŠ¤ìº” ì´í›„ **ë°±ê·¸ë¼ìš´ë“œ**ì—ì„œ êµ¬ì¶•

---

# 7. íŒŒì¼ ì“°ê¸° ì •ì±… â€” "ê°€ì‚¬(LRC)ë§Œ"

## 7.1 ì›ì¹™

| ë°ì´í„° | ì €ì¥ ìœ„ì¹˜ |
|--------|----------|
| íƒœê·¸ | DB ì •ë³¸ (íŒŒì¼ ì“°ê¸° ê¸ˆì§€) |
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ | DB ì •ë³¸ (íŒŒì¼ ì“°ê¸° ê¸ˆì§€) |
| ì¬ìƒê¸°ë¡ | DB ì •ë³¸ (íŒŒì¼ ì“°ê¸° ê¸ˆì§€) |
| **ê°€ì‚¬** | DB + LRC íŒŒì¼ (ì˜ˆì™¸) |

## 7.2 ê°€ì‚¬ LRC ì •ì±…

### ê°€ì ¸ì˜¤ê¸°

1. ë™ì¼ í´ë”ì˜ sidecar `.lrc` íŒŒì¼ ìë™ íƒìƒ‰
2. ì‚¬ìš©ì íŒŒì¼ ì„ íƒ (SAF)

### ì €ì¥í•˜ê¸°

| ì¡°ê±´ | ë™ì‘ |
|------|------|
| SAF ì†ŒìŠ¤í´ë” ë‚´ë¶€ + ì“°ê¸° ê¶Œí•œ ìœ ì§€ | ë™ì¼ í´ë”ì— `.lrc` ì €ì¥/ê°±ì‹  |
| ê·¸ ì™¸ | "ë‚´ë³´ë‚´ê¸°(ìœ„ì¹˜ ì„ íƒ)"ë¡œ ì €ì¥ |

### ì¶©ëŒ ê·œì¹™

| ìƒí™© | ê¸°ë³¸ ë™ì‘ | ì¶”ê°€ ì˜µì…˜ (Phase 2) |
|------|----------|-------------------|
| DB ê°€ì‚¬ + LRC íŒŒì¼ ë‘˜ ë‹¤ ì¡´ì¬ | DB ìš°ì„  (í¸ì§‘ë³¸ ë³´í˜¸) | "LRCë¡œ ë®ì–´ì“°ê¸°" / "DB ìœ ì§€" ì„ íƒ |

---

# 8. í”Œë ˆì´ì–´/ì˜¤ë””ì˜¤ ì •ì±…

## 8.1 ì—”ì§„ ê¸°ë³¸

- **Media3** ê¸°ë°˜ ë°±ê·¸ë¼ìš´ë“œ ì¬ìƒ
- **MediaSessionService** + ì•Œë¦¼ ì»¨íŠ¸ë¡¤ (MediaStyle)

### í êµì²´ ê·œì¹™

| ì•¡ì…˜ | ë™ì‘ |
|------|------|
| ê³¡ íƒ­ì—ì„œ ê³¡ í´ë¦­ | í˜„ì¬ íë¥¼ í•´ë‹¹ ê³¡ ì¤‘ì‹¬ìœ¼ë¡œ êµì²´ í›„ ì¬ìƒ |
| ì•¨ë²”ì—ì„œ ê³¡ í´ë¦­ | ì•¨ë²” ì „ì²´ íë¡œ êµì²´, í´ë¦­ ê³¡ë¶€í„° ì¬ìƒ |
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ì—ì„œ ê³¡ í´ë¦­ | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì „ì²´ íë¡œ êµì²´, í´ë¦­ ê³¡ë¶€í„° ì¬ìƒ |

## 8.2 ì˜¤í”„ë¡œë“œ vs DSP ìš°ì„ ìˆœìœ„

```kotlin
data class PlaybackConfig(
    val offloadEnabled: Boolean = false,  // ë°°í„°ë¦¬ ì ˆì•½
    val crossfadeEnabled: Boolean = false,
    val speedPitchEnabled: Boolean = false,
    val silenceSkipEnabled: Boolean = false,
    val eqEnabled: Boolean = false
)
```

| ì˜¤í”„ë¡œë“œ ìƒíƒœ | DSP ê¸°ëŠ¥ | í† ìŠ¤íŠ¸ ë©”ì‹œì§€ |
|-------------|---------|-------------|
| OFF (ê¸°ë³¸) | ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥ | - |
| ON | ìë™ OFF | "ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œì—ì„œ ê³ ê¸‰ ì˜¤ë””ì˜¤ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤" |

### ë¹„í™œì„± ì‚¬ìœ  í‘œì‹œ

- í”Œë ˆì´ì–´ ê³ ê¸‰ íŒ¨ë„: íšŒìƒ‰ ì²˜ë¦¬ + íˆ´íŒ
- ì„¤ì • í™”ë©´: "ì˜¤í”„ë¡œë“œ í™œì„±í™”ë¡œ ì¸í•´ ì‚¬ìš© ë¶ˆê°€" ê³ ì • í‘œì‹œ

## 8.3 í¬ë¡œìŠ¤í˜ì´ë“œ (ë“€ì–¼ í”Œë ˆì´ì–´)

### Lazy Player ì •ì±…

```kotlin
class DualPlayerManager {
    private var playerA: ExoPlayer  // í•­ìƒ ìœ ì§€
    private var playerB: ExoPlayer? = null  // í•„ìš” ì‹œ ìƒì„±
    
    fun prepareNextTrack(track: Track) {
        // íŠ¸ë™ ì „í™˜ ì§ì „ì—ë§Œ Player B ìƒì„±/ì¤€ë¹„
        playerB = createPlayer()
        playerB?.prepare(track)
    }
    
    fun executeCrossfade() {
        // ê²¹ì¹¨ ì¬ìƒ ì™„ë£Œ í›„ B í•´ì œ
        playerA.fadeOut()
        playerB?.fadeIn()
        // swap
        playerA = playerB!!
        playerB = null
    }
}
```

### ì¶©ëŒ ê·œì¹™

| í¬ë¡œìŠ¤í˜ì´ë“œ ON ì‹œ | ì œí•œ |
|------------------|------|
| Gapless Playback | ìë™ OFF |
| ì˜¤í”„ë¡œë“œ | ìë™ OFF |
| ì¼ë¶€ DSP | ì¡°í•©ì— ë”°ë¼ ì œí•œ |

> "ìë™ OFF + ì‚¬ìœ  í‘œì‹œ"ë¡œ í†µì¼ (ì¡°ìš©í•œ ì‹¤íŒ¨ ê¸ˆì§€)

## 8.4 ì…”í”Œ/ë°˜ë³µ

| ê¸°ëŠ¥ | ë™ì‘ |
|------|------|
| ì…”í”Œ | ì™„ì „ ëœë¤ (Fisher-Yates) |
| ë°˜ë³µ | ì „ì²´ / í•œê³¡ / ë” |
| ì´ì „ ê³¡ (3ì´ˆ ë£°) | â‰¤3ì´ˆ: ì´ì „ ê³¡ / >3ì´ˆ: í˜„ì¬ ê³¡ ì²˜ìŒ |

---

# 9. UI/UX ì •ì±…

## 9.1 ì ì‘í˜• ë ˆì´ì•„ì›ƒ

### Compact (ìŠ¤ë§ˆíŠ¸í°)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      TopBar         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚
â”‚      Content        â”‚
â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     MiniPlayer      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     BottomNav       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Expanded (íƒœë¸”ë¦¿/í´ë”ë¸”)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TopBar                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚                  â”‚
â”‚     Content      â”‚   PlayerScreen   â”‚
â”‚    (ì™¼ìª½ Pane)   â”‚   (ì˜¤ë¥¸ìª½ ê³ ì •)  â”‚
â”‚                  â”‚                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            BottomNav                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Expanded ë’¤ë¡œê°€ê¸° ì •ì±…

- ì˜¤ë¥¸ìª½ PlayerëŠ” **ê³ ì •** (ë’¤ë¡œê°€ê¸° ëŒ€ìƒ ì•„ë‹˜)
- ì™¼ìª½ Paneì—ì„œë§Œ ë’¤ë¡œê°€ê¸° ë„¤ë¹„ê²Œì´ì…˜ ë™ì‘
- ë’¤ë¡œê°€ê¸° ë¶ˆí•„ìš” ìƒíƒœì—ì„œëŠ” ë²„íŠ¼ ìˆ¨ê¹€

## 9.2 ë¯¸ë‹ˆ í”Œë ˆì´ì–´

| ì œìŠ¤ì²˜ | ë™ì‘ |
|--------|------|
| ì¢Œ/ìš° ìŠ¤ì™€ì´í”„ | ê³¡ ë³€ê²½ |
| íƒ­ | ë©”ì¸ í”Œë ˆì´ì–´ ì§„ì… |
| ìœ„ë¡œ ìŠ¤ì™€ì´í”„ | í”Œë ˆì´ì–´ í™•ì¥ |

## 9.3 íŠœí† ë¦¬ì–¼ ì˜¤ë²„ë ˆì´

- **ìµœì´ˆ 1íšŒ** ìë™ ë…¸ì¶œ
- ì„¤ì •ì—ì„œ "ë‹¤ì‹œ ë³´ê¸°" ì œê³µ
- ì˜¤ë²„ë ˆì´ êµ¬ì„±: "ë‹¤ìŒ" ë²„íŠ¼ + "ë‹¤ì‹œ ë³´ì§€ ì•Šê¸°" í† ê¸€
- ê¸°ëŠ¥ ë°©í•´ **ìµœì†Œí™”**

## 9.4 ê¸°ë³¸ê°’ (í™•ì •)

| í•­ëª© | ê¸°ë³¸ê°’ |
|------|--------|
| í…Œë§ˆ | ì‹œìŠ¤í…œ |
| Dynamic Color | OFF (ì»¤ìŠ¤í…€ íŒ”ë ˆíŠ¸ ìš°ì„ ) |
| ì •ë ¬ ìˆœì„œ | ì¶”ê°€ì¼ (ìµœì‹ ìˆœ) |
| í˜ì´ì§• ì‚¬ì´ì¦ˆ | 50ê°œ |
| ì´ë¯¸ì§€ ìºì‹œ | 256MB |

## 9.5 í…Œë§ˆ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ (í™•ì •)

### Light Theme: "Soft Archiving"

| ì—­í•  | ì´ë¦„ | Hex | ìš©ë„ |
|------|------|-----|------|
| Background | RicePaper | `#F9F5EC` | ë©”ì¸ ë°°ê²½ |
| Surface | CloudyBeige | `#EBE6DC` | ì¹´ë“œ, ì‹œíŠ¸ ë°°ê²½ |
| OnBackground | SootBlack | `#2D2A26` | ì£¼ìš” í…ìŠ¤íŠ¸ |
| Primary | Persimmon | `#E06F45` | ê°•ì¡°, ë²„íŠ¼, ì•¡ì…˜ |
| Secondary | FadedDenim | `#5D7582` | ë³´ì¡° í…ìŠ¤íŠ¸, ì•„ì´ì½˜ |

### Dark Theme: "Midnight Archive"

| ì—­í•  | ì´ë¦„ | Hex | ìš©ë„ |
|------|------|-----|------|
| Background | WarmCharcoal | `#1E1C1B` | ë©”ì¸ ë°°ê²½ |
| Surface | DarkEspresso | `#2C2826` | ì¹´ë“œ, ì‹œíŠ¸ ë°°ê²½ |
| OnBackground | OldPaper | `#EBE6DC` | ì£¼ìš” í…ìŠ¤íŠ¸ |
| Primary | LuminousPersimmon | `#E87A54` | ê°•ì¡°, ë²„íŠ¼, ì•¡ì…˜ |
| Secondary | AshBlue | `#8DA3B0` | ë³´ì¡° í…ìŠ¤íŠ¸, ì•„ì´ì½˜ |

### Color.kt êµ¬í˜„

```kotlin
// Light Theme Colors
val RicePaper = Color(0xFFF9F5EC)
val CloudyBeige = Color(0xFFEBE6DC)
val SootBlack = Color(0xFF2D2A26)
val Persimmon = Color(0xFFE06F45)
val FadedDenim = Color(0xFF5D7582)

// Dark Theme Colors
val WarmCharcoal = Color(0xFF1E1C1B)
val DarkEspresso = Color(0xFF2C2826)
val OldPaper = Color(0xFFEBE6DC)
val LuminousPersimmon = Color(0xFFE87A54)
val AshBlue = Color(0xFF8DA3B0)

// Color Scheme
val LightColorScheme = lightColorScheme(
    primary = Persimmon,
    onPrimary = RicePaper,
    secondary = FadedDenim,
    onSecondary = RicePaper,
    background = RicePaper,
    onBackground = SootBlack,
    surface = CloudyBeige,
    onSurface = SootBlack,
    surfaceVariant = CloudyBeige,
    onSurfaceVariant = SootBlack.copy(alpha = 0.7f)
)

val DarkColorScheme = darkColorScheme(
    primary = LuminousPersimmon,
    onPrimary = WarmCharcoal,
    secondary = AshBlue,
    onSecondary = WarmCharcoal,
    background = WarmCharcoal,
    onBackground = OldPaper,
    surface = DarkEspresso,
    onSurface = OldPaper,
    surfaceVariant = DarkEspresso,
    onSurfaceVariant = OldPaper.copy(alpha = 0.7f)
)
```

---

# 10. ë°±ì—…/ë³µì›

## 10.1 ì €ì¥ ìœ„ì¹˜

- **SAF**ë¡œ ì‚¬ìš©ì ì„ íƒ

## 10.2 í¬ë§·

```
stack_backup_20250103/
â”œâ”€â”€ metadata.json      # schemaVersion í•„ìˆ˜
â”œâ”€â”€ playlists.m3u8     # í”Œë ˆì´ë¦¬ìŠ¤íŠ¸
â”œâ”€â”€ tags.json          # íƒœê·¸ ë°ì´í„°
â”œâ”€â”€ settings.json      # ì„¤ì •
â””â”€â”€ lyrics/            # (ì˜µì…˜) LRC ëª¨ìŒ
    â”œâ”€â”€ track_001.lrc
    â””â”€â”€ ...
```

### metadata.json êµ¬ì¡°

```json
{
  "schemaVersion": 1,
  "appVersion": "1.0.0",
  "exportedAt": "2025-01-03T12:00:00Z",
  "trackCount": 1500,
  "playlistCount": 10,
  "tagCount": 25
}
```

## 10.3 ë³µì› ì •ì±… (í™•ì •)

| í•­ëª© | ê¸°ë³¸ê°’ |
|------|--------|
| ë³µì› ë°©ì‹ | **ë³‘í•©** (merge) |
| schemaVersion í˜¸í™˜ | ìµœì†Œ 2ê°œ ì´ì „ ë²„ì „ ì§€ì› |

### ë³‘í•© ê·œì¹™

| ë°ì´í„° | ì¶©ëŒ ì‹œ |
|--------|--------|
| íƒœê·¸ | ì´ë¦„ ë™ì¼ â†’ ê¸°ì¡´ ìœ ì§€, ìƒˆ íƒœê·¸ë§Œ ì¶”ê°€ |
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ | ì´ë¦„ ë™ì¼ â†’ "(ë³µì›)" ì ‘ë¯¸ì‚¬ ì¶”ê°€ |
| ì„¤ì • | ë°±ì—… ê°’ìœ¼ë¡œ ë®ì–´ì“°ê¸° |

---

# 11. Edge Case ì²˜ë¦¬ ë§¤íŠ¸ë¦­ìŠ¤

## 11.1 ìŠ¤ìº” ê´€ë ¨

| ìƒí™© | ë™ì‘ |
|------|------|
| ìŠ¤ìº” ì¤‘ ì•± ì¢…ë£Œ | ì¤‘ë‹¨ ì§€ì  ì €ì¥, ë‹¤ìŒ ì‹¤í–‰ ì‹œ ì¬ê°œ |
| ìŠ¤ìº” ì¤‘ ë„¤íŠ¸ì›Œí¬ ë³€ê²½ | ì˜í–¥ ì—†ìŒ (ë¡œì»¬ ìŠ¤ìº”) |
| ëŒ€ìš©ëŸ‰ ë¼ì´ë¸ŒëŸ¬ë¦¬ (20,000+) | ë°°ì¹˜ ì²˜ë¦¬ + ì§„í–‰ë¥  í‘œì‹œ |
| MediaStore ì ‘ê·¼ ì‹¤íŒ¨ | ì¬ì‹œë„ 3íšŒ í›„ ì—ëŸ¬ í‘œì‹œ |

## 11.2 ì¬ìƒ ê´€ë ¨

| ìƒí™© | ë™ì‘ |
|------|------|
| ì¬ìƒ ì¤‘ í•´ë‹¹ íŠ¸ë™ ì‚­ì œ | ë‹¤ìŒ ê³¡ìœ¼ë¡œ ìë™ ì „í™˜ |
| í íŠ¸ë™ì´ Ghost ë¨ | ìë™ ìŠ¤í‚µ + í† ìŠ¤íŠ¸ "íŠ¸ë™ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" |
| ì˜¤ë””ì˜¤ í¬ì»¤ìŠ¤ ì¼ì‹œ ì†ì‹¤ | Ducking ê°€ëŠ¥ ì‹œ ducking, ë¶ˆê°€ ì‹œ pause |
| ì˜¤ë””ì˜¤ í¬ì»¤ìŠ¤ ì™„ì „ ì†ì‹¤ | ì¼ì‹œì •ì§€ |
| ì´ì–´í° ë½‘í˜ (NOISY) | ì¼ì‹œì •ì§€ |
| í”„ë¡œì„¸ìŠ¤ kill í›„ ë³µê·€ | ì„¸ì…˜ ë³µì› (pause ìƒíƒœ) |
| ì¬ìƒ ì¤‘ ìŠ¤ìº” ì‹¤í–‰ | ë³‘ë ¬ ì‹¤í–‰ (DB lock ê´€ë¦¬) |

## 11.3 ì €ì¥ì†Œ ê´€ë ¨

| ìƒí™© | ë™ì‘ |
|------|------|
| ì €ì¥ ê³µê°„ ë¶€ì¡± (ë°±ì—…) | ì‹¤íŒ¨ + "N MB í•„ìš”" ì•ˆë‚´ |
| SAF ê¶Œí•œ ë§Œë£Œ | Gate í™”ë©´ìœ¼ë¡œ ì´ë™ + ì¬ì„ íƒ ìš”ì²­ |
| DB ì†ìƒ | ìë™ ë³µêµ¬ ì‹œë„ â†’ ì‹¤íŒ¨ ì‹œ ì´ˆê¸°í™” ì˜µì…˜ |

---

# 12. ìƒíƒœ ê´€ë¦¬ ì •ì±…

## 12.1 ViewModel ìƒíƒœ

```kotlin
// ê¸°ë³¸ íŒ¨í„´
class ExampleViewModel @Inject constructor(
    private val savedStateHandle: SavedStateHandle,
    private val useCase: ExampleUseCase
) : ViewModel() {
    
    private val _uiState = MutableStateFlow(ExampleUiState())
    val uiState: StateFlow<ExampleUiState> = _uiState.asStateFlow()
    
    // í”„ë¡œì„¸ìŠ¤ kill ë³µêµ¬ìš©
    private val restoredData: String? = savedStateHandle["key"]
}
```

## 12.2 í”„ë¡œì„¸ìŠ¤ ë³µêµ¬

| ë°ì´í„° | ì €ì¥ ìœ„ì¹˜ | ë³µêµ¬ |
|--------|----------|------|
| ì¬ìƒ ì„¸ì…˜ | DataStore | ìë™ ë³µì› (pause ìƒíƒœ) |
| ë„¤ë¹„ê²Œì´ì…˜ ìƒíƒœ | SavedStateHandle | ìë™ ë³µì› |
| ìŠ¤í¬ë¡¤ ìœ„ì¹˜ | SavedStateHandle | ìë™ ë³µì› |
| ê²€ìƒ‰ ì¿¼ë¦¬ | SavedStateHandle | ìë™ ë³µì› |

## 12.3 Result íŒ¨í„´

```kotlin
sealed class Result<out T> {
    data class Success<T>(val data: T) : Result<T>()
    data class Error(val exception: Throwable) : Result<Nothing>()
    object Loading : Result<Nothing>()
}
```

---

# 13. ì§„ë‹¨/ì•ˆì •ì„±

## 13.1 Crash Capture

- ì•± ë‚´ "ìµœê·¼ í¬ë˜ì‹œ ë³´ê¸°" ê¸°ë³¸ íƒ‘ì¬
- í¬ë˜ì‹œ ë¡œê·¸ ìµœëŒ€ 10ê°œ ë³´ê´€
- ì„¤ì •ì—ì„œ "ê°œë°œìì—ê²Œ ë³´ë‚´ê¸°" ì˜µì…˜

## 13.2 ë™ì‹œì„± ê·œì¹™

| ì˜ì—­ | ê·œì¹™ |
|------|------|
| ìŠ¤ìº” | ë‹¨ì¼ íŒŒì´í”„ë¼ì¸ (`Mutex`) |
| í”Œë ˆì´ì–´ ìƒíƒœ ë³€ê²½ | ë‹¨ì¼ Dispatcherì—ì„œë§Œ ìˆ˜í–‰ |
| DB ì“°ê¸° | Room ë‚´ë¶€ ê´€ë¦¬ (WAL ëª¨ë“œ) |

## 13.3 ê³ ìœ„í—˜ ì‘ì—…

| ì‘ì—… | ìš”êµ¬ì‚¬í•­ |
|------|---------|
| íŠ¸ë™ ì‚­ì œ | í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ + ì·¨ì†Œ ë²„íŠ¼ |
| ë°±ì—…/ë³µì› | ì§„í–‰ í‘œì‹œ + ì·¨ì†Œ ê°€ëŠ¥ |
| ì „ì²´ ì´ˆê¸°í™” | 2ë‹¨ê³„ í™•ì¸ |

---

# 14. ì„±ëŠ¥ ëª©í‘œ

| ì§€í‘œ | ëª©í‘œ |
|------|------|
| ì•± ì½œë“œ ìŠ¤íƒ€íŠ¸ | < 1.5ì´ˆ |
| ìŠ¤ìº” ì†ë„ (1,000ê³¡) | < 10ì´ˆ |
| ê²€ìƒ‰ ì‘ë‹µ (FTS) | < 100ms |
| ë¦¬ìŠ¤íŠ¸ ìŠ¤í¬ë¡¤ | 60fps ìœ ì§€ |
| ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | < 200MB (idle) |

---

# 15. ì ‘ê·¼ì„± ì •ì±…

| í•­ëª© | ìš”êµ¬ì‚¬í•­ |
|------|---------|
| í„°ì¹˜ íƒ€ê²Ÿ | ìµœì†Œ 48dp Ã— 48dp |
| ìƒ‰ìƒ ëŒ€ë¹„ | WCAG AA (4.5:1) |
| TalkBack | ëª¨ë“  ì¸í„°ë™í‹°ë¸Œ ìš”ì†Œ ë¼ë²¨ |
| í°íŠ¸ ìŠ¤ì¼€ì¼ë§ | ì‹œìŠ¤í…œ ì„¤ì • ì¡´ì¤‘ |

---

# 16. ê°œë°œ ìˆœì„œ (Phase ê³„íš)

## MVP (Phase 0~6)

| Phase | ë‚´ìš© | ì‚°ì¶œë¬¼ |
|-------|------|--------|
| 0 | í”„ë¡œì íŠ¸ ì„¤ì • | SSOT ë¬¸ì„œ, íŒŒì¼ íŠ¸ë¦¬, Gradle |
| 1 | ê¸°ë°˜ êµ¬ì¡° | ë©€í‹°ëª¨ë“ˆ, DI, Core utils, Theme |
| 2 | ë°ì´í„° ë ˆì´ì–´ | Room DB, Entities, DAOs, DataStore |
| 3 | ìŠ¤ìº” ì‹œìŠ¤í…œ | MediaStore ìŠ¤ìº”, SourceFolder ê´€ë¦¬ |
| 4 | Gate ì‹œìŠ¤í…œ | ê¶Œí•œ ì²˜ë¦¬, Gate ìƒíƒœë¨¸ì‹ , GateScreen |
| 5 | ì¬ìƒ ê¸°ì´ˆ | ë‹¨ì¼ ExoPlayer, Queue, MediaSession |
| 6 | UI ê¸°ì´ˆ | Navigation, Library, MiniPlayer, PlayerScreen |

### âœ… MVP ì²´í¬í¬ì¸íŠ¸
- ì•± ì„¤ì¹˜ í›„ ê¶Œí•œ ìš”ì²­ í™”ë©´ í‘œì‹œ
- ê¶Œí•œ í—ˆìš© + í´ë” ì„ íƒ í›„ ìŠ¤ìº” ì‹œì‘
- ìŠ¤ìº”ëœ íŠ¸ë™ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
- íŠ¸ë™ íƒ­í•˜ë©´ ì¬ìƒ ì‹œì‘
- MiniPlayer í‘œì‹œ ë° ê¸°ë³¸ ì»¨íŠ¸ë¡¤
- ì „ì²´ í™”ë©´ í”Œë ˆì´ì–´
- ë°±ê·¸ë¼ìš´ë“œ ì¬ìƒ + ì•Œë¦¼
- ì•± ì¬ì‹œì‘ ì‹œ ì„¸ì…˜ ë³µì› (ì¼ì‹œì •ì§€ ìƒíƒœ)

## Phase 2: ì•„ì¹´ì´ë¸Œ ê°•í™”

- ì•¨ë²”/ì•„í‹°ìŠ¤íŠ¸ (ê·¸ë¦¬ë“œ/ë¦¬ìŠ¤íŠ¸)
- íƒœê·¸ ì‹œìŠ¤í…œ ì™„ì„±
- í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ (ìŠ¤ë§ˆíŠ¸/ë©”íƒ€)
- ê³ ì† ìŠ¤í¬ë¡¤/ì„¹ì…˜ ì¸ë±ìŠ¤
- ê²€ìƒ‰ (FTS5) ì™„ì„±
- ê°€ì‚¬ í¸ì§‘ê¸°

## Phase 3: ê³ ê¸‰ ì¬ìƒ

- í¬ë¡œìŠ¤í˜ì´ë“œ (ë“€ì–¼ í”Œë ˆì´ì–´)
- ë¬´ìŒ ê±´ë„ˆë›°ê¸° / EQ
- ì†ë„/í”¼ì¹˜/A-B ë°˜ë³µ
- Android Auto

## Phase 4: í´ë¦¬ì‹±

- Ambient Background
- Widget (Glance)
- ë°±ì—…/ë³µì› ì™„ì„±
- ì„±ëŠ¥ ìµœì í™”
- ì ‘ê·¼ì„± ê²€ì¦

## Phase 5: ë¦´ë¦¬ì¦ˆ

- í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- ProGuard ìµœì í™”
- Play Store ì¤€ë¹„

---

# ë¶€ë¡ A: libs.versions.toml ì „ì²´

```toml
[versions]
# Build Tools
agp = "8.7.3"
kotlin = "2.0.21"
ksp = "2.0.21-1.0.28"

# AndroidX Core
coreKtx = "1.15.0"
appcompat = "1.7.0"
activityCompose = "1.9.3"
lifecycleRuntimeK
